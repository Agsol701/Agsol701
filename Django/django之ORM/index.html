



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
        <meta name="author" content="Agsol">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1, mkdocs-material-4.6.3">
    
    
      
        <title>django之ORM - Agsol的技术栈</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.adb8469c.css">
      
      
    
    
      <script src="../../assets/javascripts/modernizr.86422ebf.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#orm" tabindex="0" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../.." title="Agsol的技术栈" aria-label="Agsol的技术栈" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Agsol的技术栈
            </span>
            <span class="md-header-nav__topic">
              
                django之ORM
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" aria-label="search" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../.." title="Agsol的技术栈" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    Agsol的技术栈
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      组成原理
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        组成原理
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/" title="计算机基础" class="md-nav__link">
      计算机基础
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Python
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Python
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Python/%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/" title="基本数据类型" class="md-nav__link">
      基本数据类型
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Python/%E5%B8%B8%E9%87%8F%E4%B8%8E%E5%8F%98%E9%87%8F/" title="常量与变量" class="md-nav__link">
      常量与变量
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Python/%E6%95%B0%E5%80%BC%E7%B1%BB%E5%9E%8B/" title="数值类型" class="md-nav__link">
      数值类型
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Python/%E5%9F%BA%E6%9C%AC%E8%BF%90%E7%AE%97%E7%AC%A6/" title="基本运算符" class="md-nav__link">
      基本运算符
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Python/%E5%AD%97%E7%AC%A6%E4%B8%B2/" title="字符串" class="md-nav__link">
      字符串
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Python/%E5%88%97%E8%A1%A8/" title="列表" class="md-nav__link">
      列表
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Python/%E5%AD%97%E5%85%B8/" title="字典" class="md-nav__link">
      字典
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Python/%E9%9B%86%E5%90%88/" title="集合" class="md-nav__link">
      集合
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Python/bytesbytearray/" title="bytesbytearray" class="md-nav__link">
      bytesbytearray
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Python/%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6/" title="流程控制" class="md-nav__link">
      流程控制
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Python/%E5%87%BD%E6%95%B0/" title="函数" class="md-nav__link">
      函数
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Python/%E5%86%85%E5%BB%BA%E5%87%BD%E6%95%B0/" title="内建函数" class="md-nav__link">
      内建函数
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Python/%E9%80%92%E5%BD%92%E5%87%BD%E6%95%B0/" title="递归函数" class="md-nav__link">
      递归函数
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Python/%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/" title="文件处理" class="md-nav__link">
      文件处理
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Python/%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81/" title="字符编码" class="md-nav__link">
      字符编码
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Python/%E5%9B%9B%E5%BC%8F%E5%9B%9B%E5%99%A8/" title="四式四器" class="md-nav__link">
      四式四器
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Python/%E7%B1%BB/" title="类" class="md-nav__link">
      类
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Python/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/" title="面向对象" class="md-nav__link">
      面向对象
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Python/%E6%A8%A1%E5%9D%97/" title="模块" class="md-nav__link">
      模块
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Python/%E8%BF%9B%E7%A8%8B%E5%92%8C%E7%BA%BF%E7%A8%8B/" title="进程和线程" class="md-nav__link">
      进程和线程
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Python/Python%E4%B8%AD%E7%9A%84%E8%BF%9B%E7%A8%8B/" title="Python中的进程" class="md-nav__link">
      Python中的进程
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Python/Python%E4%B8%AD%E7%9A%84%E7%BA%BF%E7%A8%8B/" title="Python中的线程" class="md-nav__link">
      Python中的线程
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Python/%E7%BA%BF%E7%A8%8B%E5%90%8C%E6%AD%A5/" title="线程同步" class="md-nav__link">
      线程同步
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Python/%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86/" title="异常处理" class="md-nav__link">
      异常处理
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Golang
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Golang
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Golang/golang%E7%AE%80%E4%BB%8B%E5%8F%8A%E5%AE%89%E8%A3%85/" title="golang简介及安装" class="md-nav__link">
      golang简介及安装
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Golang/%E4%BB%A3%E7%A0%81%E7%BB%93%E6%9E%84%E5%92%8C%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/" title="代码结构和基础语法" class="md-nav__link">
      代码结构和基础语法
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Golang/%E8%BF%9B%E5%88%B6%E5%8F%8A%E5%8E%9F%E7%A0%81/" title="进制及原码" class="md-nav__link">
      进制及原码
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Golang/%E5%8F%98%E9%87%8F%E5%92%8C%E5%B8%B8%E9%87%8F/" title="变量和常量" class="md-nav__link">
      变量和常量
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Golang/%E6%A0%87%E8%AF%86%E7%AC%A6%E5%8F%8A%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/" title="标识符及数据类型" class="md-nav__link">
      标识符及数据类型
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Golang/%E6%95%B0%E5%AD%97%E7%B1%BB%E5%9E%8B/" title="数字类型" class="md-nav__link">
      数字类型
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Golang/%E5%B8%83%E5%B0%94%E7%B1%BB%E5%9E%8B/" title="布尔类型" class="md-nav__link">
      布尔类型
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Golang/%E5%AD%97%E7%AC%A6%E7%B1%BB%E5%9E%8B/" title="字符类型" class="md-nav__link">
      字符类型
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Golang/%E8%BF%90%E7%AE%97%E7%AC%A6/" title="运算符" class="md-nav__link">
      运算符
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Golang/%E5%8C%85/" title="包" class="md-nav__link">
      包
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Golang/%E5%AD%97%E7%AC%A6%E4%B8%B2/" title="字符串" class="md-nav__link">
      字符串
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Golang/%E8%BE%93%E5%85%A5%E8%AF%AD%E5%8F%A5/" title="输入语句" class="md-nav__link">
      输入语句
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Golang/%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C/" title="文件操作" class="md-nav__link">
      文件操作
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Golang/%E5%87%BD%E6%95%B0/" title="函数" class="md-nav__link">
      函数
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Golang/%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6/" title="流程控制" class="md-nav__link">
      流程控制
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Golang/%E6%95%B0%E7%BB%84/" title="数组" class="md-nav__link">
      数组
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Golang/%E5%88%87%E7%89%87/" title="切片" class="md-nav__link">
      切片
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Golang/map/" title="map" class="md-nav__link">
      map
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Golang/%E6%8C%87%E9%92%88/" title="指针" class="md-nav__link">
      指针
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Golang/%E7%BB%93%E6%9E%84%E4%BD%93/" title="结构体" class="md-nav__link">
      结构体
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Golang/%E7%BB%93%E6%9E%84%E4%BD%93%E7%9A%84%E6%96%B9%E6%B3%95/" title="结构体的方法" class="md-nav__link">
      结构体的方法
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Golang/%E7%BB%93%E6%9E%84%E4%BD%93%E7%9A%84%E5%8C%BF%E5%90%8D%E5%AD%97%E6%AE%B5/" title="结构体的匿名字段" class="md-nav__link">
      结构体的匿名字段
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Golang/%E6%8E%A5%E5%8F%A3/" title="接口" class="md-nav__link">
      接口
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Golang/goroutine/" title="goroutine" class="md-nav__link">
      goroutine
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Golang/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/" title="并发编程" class="md-nav__link">
      并发编程
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Golang/%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86/" title="异常处理" class="md-nav__link">
      异常处理
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Golang/%E5%8F%8D%E5%B0%84/" title="反射" class="md-nav__link">
      反射
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Golang/%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/" title="单元测试" class="md-nav__link">
      单元测试
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Golang/json/" title="json" class="md-nav__link">
      json
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5" checked>
    
    <label class="md-nav__link" for="nav-5">
      Django
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Django
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../django%E5%89%8D%E8%A8%80/" title="django前言" class="md-nav__link">
      django前言
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../django%E5%9F%BA%E7%A1%80%E4%B8%89%E6%9D%BF%E6%96%A7/" title="django基础三板斧" class="md-nav__link">
      django基础三板斧
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../django%E9%9D%99%E6%80%81%E6%96%87%E4%BB%B6/" title="django静态文件" class="md-nav__link">
      django静态文件
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../django%E8%BF%9E%E6%8E%A5MySQL/" title="django连接MySQL" class="md-nav__link">
      django连接MySQL
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../MTV%E4%B8%8EMVC%E6%A8%A1%E5%9E%8B/" title="MTV与MVC模型" class="md-nav__link">
      MTV与MVC模型
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../django%E4%B9%8B%E8%B7%AF%E7%94%B1%E5%B1%82/" title="django之路由层" class="md-nav__link">
      django之路由层
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../django%E4%B9%8B%E8%A7%86%E5%9B%BE%E5%B1%82/" title="django之视图层" class="md-nav__link">
      django之视图层
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../django%E4%B9%8B%E6%A8%A1%E6%9D%BF%E5%B1%82/" title="django之模板层" class="md-nav__link">
      django之模板层
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        django之ORM
      </label>
    
    <a href="./" title="django之ORM" class="md-nav__link md-nav__link--active">
      django之ORM
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    配置测试文件
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    第一种方法：
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    第二种方法：
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sql" class="md-nav__link">
    配置显示sql语句日志
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../django%E4%B9%8B%E5%88%86%E7%BB%84%E6%9F%A5%E8%AF%A2/" title="django之分组查询" class="md-nav__link">
      django之分组查询
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../django%E4%B9%8BORM%E4%BC%98%E5%8C%96%E6%9F%A5%E8%AF%A2/" title="django之ORM优化查询" class="md-nav__link">
      django之ORM优化查询
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../django%E5%92%8Cajax/" title="django和ajax" class="md-nav__link">
      django和ajax
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../django%E5%BA%8F%E5%88%97%E5%8C%96%E6%A8%A1%E5%9D%97/" title="django序列化模块" class="md-nav__link">
      django序列化模块
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../%E5%A4%9A%E5%AF%B9%E5%A4%9A%E4%B8%89%E7%A7%8D%E5%88%9B%E5%BB%BA%E6%96%B9%E6%B3%95/" title="多对多三种创建方法" class="md-nav__link">
      多对多三种创建方法
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../django%E4%B9%8Bforms%E7%BB%84%E4%BB%B6/" title="django之forms组件" class="md-nav__link">
      django之forms组件
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../django%E4%B9%8Bcookies%E5%92%8Csession%E7%BB%84%E4%BB%B6/" title="django之cookies和session组件" class="md-nav__link">
      django之cookies和session组件
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../django%E4%B8%AD%E9%97%B4%E4%BB%B6/" title="django中间件" class="md-nav__link">
      django中间件
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      drf
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        drf
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../drf/Restful%E8%A7%84%E8%8C%83/" title="Restful规范" class="md-nav__link">
      Restful规范
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../drf中的APIView请求生命周期.md" title="drf中的APIView请求生命周期" class="md-nav__link">
      drf中的APIView请求生命周期
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../drf序列化组件.md" title="drf序列化组件" class="md-nav__link">
      drf序列化组件
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../多表操作.md" title="多表操作" class="md-nav__link">
      多表操作
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../drf序列化组件实现十大接口.md" title="drf序列化组件实现十大接口" class="md-nav__link">
      drf序列化组件实现十大接口
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../视图家族.md" title="视图家族" class="md-nav__link">
      视图家族
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../jwt认证.md" title="jwt认证" class="md-nav__link">
      jwt认证
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../三大认证.md" title="三大认证" class="md-nav__link">
      三大认证
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../多方式登录.md" title="多方式登录" class="md-nav__link">
      多方式登录
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../三大组件源码分析.md" title="三大组件源码分析" class="md-nav__link">
      三大组件源码分析
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      网络编程
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        网络编程
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/" title="网络编程" class="md-nav__link">
      网络编程
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/%E7%BD%91%E7%BB%9C%E6%A8%A1%E5%9E%8B/" title="网络模型" class="md-nav__link">
      网络模型
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/Dns%E8%AF%A6%E8%A7%A3/" title="Dns详解" class="md-nav__link">
      Dns详解
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/http%E5%8D%8F%E8%AE%AE/" title="http协议" class="md-nav__link">
      http协议
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/CGI%2CwSGI%2CuWSGI%2Cuwsgi/" title="CGI,wSGI,uWSGI,uwsgi" class="md-nav__link">
      CGI,wSGI,uWSGI,uwsgi
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      Redis
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        Redis
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Redis/Redis/" title="Redis" class="md-nav__link">
      Redis
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Redis/Golang%E4%B8%AD%E4%BD%BF%E7%94%A8Redis/" title="Golang中使用Redis" class="md-nav__link">
      Golang中使用Redis
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Redis/Python%E4%B8%AD%E4%BD%BF%E7%94%A8Redis/" title="Python中使用Redis" class="md-nav__link">
      Python中使用Redis
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9">
    
    <label class="md-nav__link" for="nav-9">
      MySQL
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        MySQL
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../MySQL/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/" title="数据库基础" class="md-nav__link">
      数据库基础
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../MySQL/%E5%BA%93%E8%A1%A8%E5%80%BC%E7%9A%84%E6%93%8D%E4%BD%9C/" title="库表值的操作" class="md-nav__link">
      库表值的操作
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../MySQL/pymysql/" title="pymysql" class="md-nav__link">
      pymysql
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../MySQL/MySQL%E4%B8%BB%E4%BB%8E%E6%90%AD%E5%BB%BA/" title="MySQL主从搭建" class="md-nav__link">
      MySQL主从搭建
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-10" type="checkbox" id="nav-10">
    
    <label class="md-nav__link" for="nav-10">
      MongoDB
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-10">
        MongoDB
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../MongoDB/MongoDB%E5%AE%89%E8%A3%85/" title="MongoDB安装" class="md-nav__link">
      MongoDB安装
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-11" type="checkbox" id="nav-11">
    
    <label class="md-nav__link" for="nav-11">
      Docker
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-11">
        Docker
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Docker/Docker%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%AE%89%E8%A3%85/" title="Docker简介与安装" class="md-nav__link">
      Docker简介与安装
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Docker/Docker%E9%95%9C%E5%83%8F/" title="Docker镜像" class="md-nav__link">
      Docker镜像
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Docker/Docker%E5%AE%B9%E5%99%A8/" title="Docker容器" class="md-nav__link">
      Docker容器
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Docker/Docker%E5%85%B6%E4%BB%96/" title="Docker其他" class="md-nav__link">
      Docker其他
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-12" type="checkbox" id="nav-12">
    
    <label class="md-nav__link" for="nav-12">
      数据结构
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-12">
        数据结构
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%A0%91/" title="树" class="md-nav__link">
      树
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E9%98%9F%E5%88%97/" title="队列" class="md-nav__link">
      队列
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E9%93%BE%E8%A1%A8/" title="链表" class="md-nav__link">
      链表
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E7%A8%80%E7%96%8F%E6%95%B0%E7%BB%84/" title="稀疏数组" class="md-nav__link">
      稀疏数组
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    配置测试文件
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    第一种方法：
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    第二种方法：
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sql" class="md-nav__link">
    配置显示sql语句日志
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <div class="toc">
<ul>
<li><a href="#orm">ORM</a><ul>
<li><a href="#_1">配置测试文件</a><ul>
<li><a href="#_2">第一种方法：</a></li>
<li><a href="#_3">第二种方法：</a></li>
</ul>
</li>
<li><a href="#sql">配置显示sql语句日志</a></li>
</ul>
</li>
<li><a href="#_4">数据的操作</a></li>
<li><a href="#_5">表数据操作</a><ul>
<li><a href="#_6">增</a></li>
<li><a href="#_7">改</a></li>
<li><a href="#_8">删</a></li>
<li><a href="#13">查(13条)</a><ul>
<li><a href="#1all">1.all()</a></li>
<li><a href="#2filter">2.filter()</a></li>
<li><a href="#3get">3.get()</a></li>
<li><a href="#getfilter">get和filter的区别</a></li>
<li><a href="#4first">4.first()</a></li>
<li><a href="#5last">5.last()</a></li>
<li><a href="#6count">6.count()</a></li>
<li><a href="#7values">7.values()</a></li>
<li><a href="#8values_list">8.values_list()</a></li>
<li><a href="#9order_by">9.order_by()</a></li>
<li><a href="#10reverse">10.reverse()</a></li>
<li><a href="#11exclude">11.exclude()</a></li>
<li><a href="#12exists">12.exists()</a></li>
<li><a href="#13distinct">13.distinct()</a></li>
</ul>
</li>
<li><a href="#_9">注意事项</a></li>
</ul>
</li>
<li><a href="#_10">双下划线查询</a></li>
<li><a href="#_11">模糊查询</a><ul>
<li><a href="#mysql">MySQL中的模糊查询</a></li>
</ul>
</li>
<li><a href="#_12">多表操作</a><ul>
<li><a href="#_13">一对多表</a><ul>
<li><a href="#_14">增</a></li>
<li><a href="#_15">查</a></li>
<li><a href="#_16">改</a></li>
<li><a href="#_17">删</a></li>
</ul>
</li>
<li><a href="#_18">多对多表</a><ul>
<li><a href="#_19">增</a></li>
<li><a href="#_20">改</a></li>
<li><a href="#_21">删</a><ul>
<li><a href="#remove">remove方法</a></li>
<li><a href="#clear">clear()方法</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#_22">跨表查询</a><ul>
<li><a href="#_23">正反向查询</a></li>
<li><a href="#_24">子查询</a><ul>
<li><a href="#_25">基于对象的跨表查询</a></li>
<li><a href="#_26">注意</a></li>
</ul>
</li>
<li><a href="#_27">基于双下划线的跨表操作</a></li>
</ul>
</li>
<li><a href="#orm_1">ORM字段及参数</a><ul>
<li><a href="#_28">字段</a></li>
</ul>
</li>
<li><a href="#_29">自定义字段</a></li>
<li><a href="#orm_2">ORM优化查询</a><ul>
<li><a href="#only">only()</a></li>
<li><a href="#defer">defer()</a></li>
<li><a href="#select_related">select_related()</a></li>
<li><a href="#prefetch_related">prefetch_related()</a></li>
<li><a href="#orm_3">orm常用字段</a></li>
</ul>
</li>
<li><a href="#choice">choice参数</a><ul>
<li><a href="#_30">字段参数</a></li>
<li><a href="#_31">外键字段的参数</a></li>
</ul>
</li>
<li><a href="#models">由数据库反向生成models</a></li>
</ul>
</div>
<h1 id="orm">ORM<a class="headerlink" href="#orm" title="Permanent link">&para;</a></h1>
<h3 id="_1">配置测试文件<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h3>
<p>去manage.py中拷贝下面语句并复制到test.py中,或另外自己新建的测试文件也可以.</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s2">&quot;DJANGO_SETTINGS_MODULE&quot;</span><span class="p">,</span> <span class="s2">&quot;library00.settings&quot;</span><span class="p">)</span>
</code></pre></div>

<p>然后导入模块,方法和文件</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">django</span>
<span class="n">django</span><span class="o">.</span><span class="n">setup</span><span class="p">()</span>

<span class="kn">from</span> <span class="nn">app01</span> <span class="kn">import</span> <span class="n">models</span>  <span class="c1">#待测试文件的导入一定要在django.setup之后</span>
</code></pre></div>

<h5 id="_2">第一种方法：<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h5>
<ul>
<li>直接在某一个应用下的test文件中书写（前四行代码去manage.py中拷贝）：</li>
</ul>
<div class="codehilite"><pre><span></span><code>import os

if __name__ == &quot;__main__&quot;:
    os.environ.setdefault(&quot;DJANGO_SETTINGS_MODULE&quot;, &quot;mysite.settings&quot;)

    import django
    django.setup()
</code></pre></div>

<h5 id="_3">第二种方法：<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h5>
<p>直接新建一个任意名称的py文件 在里面写上上面的配置</p>
<h3 id="sql">配置显示sql语句日志<a class="headerlink" href="#sql" title="Permanent link">&para;</a></h3>
<p>settings中加下列代码</p>
<div class="codehilite"><pre><span></span><code><span class="n">LOGGING</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;disable_existing_loggers&#39;</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span>
    <span class="s1">&#39;handlers&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;console&#39;</span><span class="p">:{</span>
            <span class="s1">&#39;level&#39;</span><span class="p">:</span><span class="s1">&#39;DEBUG&#39;</span><span class="p">,</span>
            <span class="s1">&#39;class&#39;</span><span class="p">:</span><span class="s1">&#39;logging.StreamHandler&#39;</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">},</span>
    <span class="s1">&#39;loggers&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;django.db.backends&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;handlers&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;console&#39;</span><span class="p">],</span>
            <span class="s1">&#39;propagate&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
            <span class="s1">&#39;level&#39;</span><span class="p">:</span><span class="s1">&#39;DEBUG&#39;</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h1 id="_4">数据的操作<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h1>
<p>建表</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">django.db</span> <span class="kn">import</span> <span class="n">models</span>

<span class="c1"># Create your models here.</span>

<span class="k">class</span> <span class="nc">Book</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>
    <span class="n">price</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DecimalField</span><span class="p">(</span><span class="n">max_digits</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="n">decimal_places</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">publicdata</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateField</span><span class="p">(</span><span class="n">auto_now_add</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">public</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">to</span><span class="o">=</span><span class="s2">&quot;Public&quot;</span><span class="p">)</span>
    <span class="n">author</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ManyToManyField</span><span class="p">(</span><span class="n">to</span><span class="o">=</span><span class="s2">&quot;Author&quot;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">Public</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>
    <span class="n">addr</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">Author</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>
    <span class="n">enail</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">EmailField</span><span class="p">()</span>
    <span class="n">author_detail</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">OneToOneField</span><span class="p">(</span><span class="n">to</span><span class="o">=</span><span class="s2">&quot;AuthorDetail&quot;</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">AuthorDetail</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">phone</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">BigIntegerField</span><span class="p">()</span>
    <span class="n">addr</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>
</code></pre></div>

<h1 id="_5">表数据操作<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h1>
<h5 id="_6">增<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h5>
<p>增加一个对象</p>
<p>方法一</p>
<div class="codehilite"><pre><span></span><code><span class="c1">#手动添加数据</span>
<span class="c1"># book_obj = models.Books.objects.create(title=&#39;harry&#39;,price=120.12,publishdata=&#39;2019-11-11&#39;)</span>
<span class="c1">#自动导入时间</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="n">ctime</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">today</span><span class="p">()</span>
<span class="n">book_obj</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Books</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;potter&#39;</span><span class="p">,</span><span class="n">price</span><span class="o">=</span><span class="mf">24.034</span><span class="p">,</span><span class="n">publishdata</span><span class="o">=</span><span class="n">ctime</span><span class="p">)</span>
</code></pre></div>

<p>方法二</p>
<div class="codehilite"><pre><span></span><code><span class="c1">#生成对象,后使用save()方法</span>
<span class="n">book_obj</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Books</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;西游记&quot;</span><span class="p">,</span><span class="n">price</span><span class="o">=</span><span class="mf">333.445</span><span class="p">,</span><span class="n">publishdata</span><span class="o">=</span><span class="s2">&quot;1994-2-3&quot;</span><span class="p">)</span>
<span class="n">book_obj</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</code></pre></div>

<h5 id="_7">改<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h5>
<p>改某个对象中的一个字段的数据</p>
<p>方法一</p>
<div class="codehilite"><pre><span></span><code><span class="c1">#使用queryset方法</span>
<span class="n">models</span><span class="o">.</span><span class="n">Books</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">price</span><span class="o">=</span><span class="mi">333</span><span class="p">)</span>
</code></pre></div>

<p>方法二</p>
<div class="codehilite"><pre><span></span><code><span class="c1">#利用对象</span>
<span class="n">book_obj</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Books</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">book_obj</span><span class="o">.</span><span class="n">price</span><span class="o">=</span><span class="mi">222</span>
<span class="n">book_obj</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</code></pre></div>

<p>不推荐使用这种方法,这种方式实际上是将每部数据所有字段全部重写一边,效率低</p>
<h5 id="_8">删<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h5>
<p>方法一</p>
<div class="codehilite"><pre><span></span><code><span class="c1">#利用queryset方法 delete()</span>
<span class="n">models</span><span class="o">.</span><span class="n">Books</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
</code></pre></div>

<p>方法二</p>
<div class="codehilite"><pre><span></span><code><span class="c1">#对象方法</span>
<span class="n">book_obj</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Books</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">book_obj</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
</code></pre></div>

<p>对象方法直接.delete().不需要保存.</p>
<h5 id="13">查(13条)<a class="headerlink" href="#13" title="Permanent link">&para;</a></h5>
<p>django的ORM语句默认惰性查询,当你需要使用数据的时候才执行ORM语句</p>
<h6 id="1all">1.all()<a class="headerlink" href="#1all" title="Permanent link">&para;</a></h6>
<p>查询所有,返回QuerySet对象,形式列表套对象</p>
<div class="codehilite"><pre><span></span><code><span class="n">book_obj</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Books</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">book_obj</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">book_obj</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="p">(</span><span class="mf">0.000</span><span class="p">)</span> <span class="n">SELECT</span> <span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`id`</span><span class="p">,</span> <span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`title`</span><span class="p">,</span> <span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`price`</span><span class="p">,</span> <span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`publishdata`</span> <span class="n">FROM</span> <span class="sb">`app01_books`</span> <span class="n">LIMIT</span> <span class="mi">21</span><span class="p">;</span> <span class="n">args</span><span class="o">=</span><span class="p">()</span>
<span class="o">&lt;</span><span class="n">QuerySet</span> <span class="p">[</span><span class="o">&lt;</span><span class="n">Books</span><span class="p">:</span> <span class="n">Books</span> <span class="nb">object</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">Books</span><span class="p">:</span> <span class="n">Books</span> <span class="nb">object</span><span class="o">&gt;</span><span class="p">]</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">django</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">query</span><span class="o">.</span><span class="n">QuerySet</span><span class="s1">&#39;&gt;</span>
</code></pre></div>

<h6 id="2filter">2.filter()<a class="headerlink" href="#2filter" title="Permanent link">&para;</a></h6>
<p>筛选,返回queryset对象,列表套对象</p>
<p>相当于原生sql中的where关键字</p>
<p>支持多个参数同时查询,相当于and关系,即返回同时成立对象</p>
<div class="codehilite"><pre><span></span><code><span class="n">book_obj</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Books</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;potter&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">book_obj</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">book_obj</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="p">(</span><span class="mf">0.003</span><span class="p">)</span> <span class="n">SELECT</span> <span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`id`</span><span class="p">,</span> <span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`title`</span><span class="p">,</span> <span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`price`</span><span class="p">,</span> <span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`publishdata`</span> <span class="n">FROM</span> <span class="sb">`app01_books`</span> <span class="n">WHERE</span> <span class="p">(</span><span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`id`</span> <span class="o">=</span> <span class="mi">2</span> <span class="n">AND</span> <span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`title`</span> <span class="o">=</span> <span class="s1">&#39;potter&#39;</span><span class="p">)</span> <span class="n">LIMIT</span> <span class="mi">21</span><span class="p">;</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;potter&#39;</span><span class="p">)</span>
<span class="o">&lt;</span><span class="n">QuerySet</span> <span class="p">[</span><span class="o">&lt;</span><span class="n">Books</span><span class="p">:</span> <span class="n">Books</span> <span class="nb">object</span><span class="o">&gt;</span><span class="p">]</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">django</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">query</span><span class="o">.</span><span class="n">QuerySet</span><span class="s1">&#39;&gt;</span>
</code></pre></div>

<h6 id="3get">3.get()<a class="headerlink" href="#3get" title="Permanent link">&para;</a></h6>
<p>筛选,返回一个对象</p>
<div class="codehilite"><pre><span></span><code><span class="n">book_obj</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Books</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">book_obj</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">book_obj</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="p">(</span><span class="mf">0.003</span><span class="p">)</span> <span class="n">SELECT</span> <span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`id`</span><span class="p">,</span> <span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`title`</span><span class="p">,</span> <span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`price`</span><span class="p">,</span> <span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`publishdata`</span> <span class="n">FROM</span> <span class="sb">`app01_books`</span> <span class="n">WHERE</span> <span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`id`</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,)</span>
<span class="n">Books</span> <span class="nb">object</span>
<span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">app01</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">Books</span><span class="s1">&#39;&gt;</span>
</code></pre></div>

<h6 id="getfilter">get和filter的区别<a class="headerlink" href="#getfilter" title="Permanent link">&para;</a></h6>
<ol>
<li>filter获取到的是一个quertset对象,类似于一个列表,条件不存在时,返回一个空</li>
<li>get获取到的直接是数据对象本身,条件不存在时,报错</li>
</ol>
<h6 id="4first">4.first()<a class="headerlink" href="#4first" title="Permanent link">&para;</a></h6>
<p>返回queryset中第一个数据对象</p>
<div class="codehilite"><pre><span></span><code><span class="n">book_obj</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Books</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">book</span> <span class="o">=</span> <span class="n">book_obj</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">book_obj</span><span class="p">,</span><span class="s2">&quot;1&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">book_obj</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">book</span><span class="p">,</span><span class="s2">&quot;2&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">book</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="p">(</span><span class="mf">0.001</span><span class="p">)</span> <span class="n">SELECT</span> <span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`id`</span><span class="p">,</span> <span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`title`</span><span class="p">,</span> <span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`price`</span><span class="p">,</span> <span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`publishdata`</span> <span class="n">FROM</span> <span class="sb">`app01_books`</span> <span class="n">WHERE</span> <span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`id`</span> <span class="o">=</span> <span class="mi">2</span> <span class="n">ORDER</span> <span class="n">BY</span> <span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`id`</span> <span class="n">ASC</span> <span class="n">LIMIT</span> <span class="mi">1</span><span class="p">;</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,)</span>
<span class="p">(</span><span class="mf">0.000</span><span class="p">)</span> <span class="n">SELECT</span> <span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`id`</span><span class="p">,</span> <span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`title`</span><span class="p">,</span> <span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`price`</span><span class="p">,</span> <span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`publishdata`</span> <span class="n">FROM</span> <span class="sb">`app01_books`</span> <span class="n">WHERE</span> <span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`id`</span> <span class="o">=</span> <span class="mi">2</span> <span class="n">LIMIT</span> <span class="mi">21</span><span class="p">;</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,)</span>
<span class="o">&lt;</span><span class="n">QuerySet</span> <span class="p">[</span><span class="o">&lt;</span><span class="n">Books</span><span class="p">:</span> <span class="n">Books</span> <span class="nb">object</span><span class="o">&gt;</span><span class="p">]</span><span class="o">&gt;</span> <span class="mi">1</span>
<span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">django</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">query</span><span class="o">.</span><span class="n">QuerySet</span><span class="s1">&#39;&gt;</span>
<span class="n">Books</span> <span class="nb">object</span> <span class="mi">2</span>
<span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">app01</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">Books</span><span class="s1">&#39;&gt;</span>
</code></pre></div>

<h6 id="5last">5.last()<a class="headerlink" href="#5last" title="Permanent link">&para;</a></h6>
<p>返回queryset中第最后一个数据对象</p>
<div class="codehilite"><pre><span></span><code><span class="n">book_obj</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Books</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">book</span> <span class="o">=</span> <span class="n">book_obj</span><span class="o">.</span><span class="n">last</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">book_obj</span><span class="p">,</span><span class="s2">&quot;1&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">book_obj</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">book</span><span class="p">,</span><span class="s2">&quot;2&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">book</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="p">(</span><span class="mf">0.001</span><span class="p">)</span> <span class="n">SELECT</span> <span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`id`</span><span class="p">,</span> <span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`title`</span><span class="p">,</span> <span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`price`</span><span class="p">,</span> <span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`publishdata`</span> <span class="n">FROM</span> <span class="sb">`app01_books`</span> <span class="n">WHERE</span> <span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`id`</span> <span class="o">=</span> <span class="mi">2</span> <span class="n">ORDER</span> <span class="n">BY</span> <span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`id`</span> <span class="n">DESC</span> <span class="n">LIMIT</span> <span class="mi">1</span><span class="p">;</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,)</span>
<span class="p">(</span><span class="mf">0.000</span><span class="p">)</span> <span class="n">SELECT</span> <span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`id`</span><span class="p">,</span> <span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`title`</span><span class="p">,</span> <span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`price`</span><span class="p">,</span> <span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`publishdata`</span> <span class="n">FROM</span> <span class="sb">`app01_books`</span> <span class="n">WHERE</span> <span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`id`</span> <span class="o">=</span> <span class="mi">2</span> <span class="n">LIMIT</span> <span class="mi">21</span><span class="p">;</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,)</span>
<span class="o">&lt;</span><span class="n">QuerySet</span> <span class="p">[</span><span class="o">&lt;</span><span class="n">Books</span><span class="p">:</span> <span class="n">Books</span> <span class="nb">object</span><span class="o">&gt;</span><span class="p">]</span><span class="o">&gt;</span> <span class="mi">1</span>
<span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">django</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">query</span><span class="o">.</span><span class="n">QuerySet</span><span class="s1">&#39;&gt;</span>
<span class="n">Books</span> <span class="nb">object</span> <span class="mi">2</span>
<span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">app01</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">Books</span><span class="s1">&#39;&gt;</span>
</code></pre></div>

<h6 id="6count">6.count()<a class="headerlink" href="#6count" title="Permanent link">&para;</a></h6>
<p>统计数据的个数  返回整型</p>
<div class="codehilite"><pre><span></span><code><span class="n">book_obj</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Books</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">book_obj</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">book_obj</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="p">(</span><span class="mf">0.003</span><span class="p">)</span> <span class="n">SELECT</span> <span class="n">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="n">AS</span> <span class="sb">`__count`</span> <span class="n">FROM</span> <span class="sb">`app01_books`</span><span class="p">;</span> <span class="n">args</span><span class="o">=</span><span class="p">()</span>
<span class="mi">2</span>
<span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">int</span><span class="s1">&#39;&gt;</span>
</code></pre></div>

<p>注意:count()前时objects,默认计算表内所有数据,前面亦可加其他筛选条件</p>
<h6 id="7values">7.values()<a class="headerlink" href="#7values" title="Permanent link">&para;</a></h6>
<p>获取数据对象中指定的字段的值,返回queryset对象,形式为列表套字典.返回字典</p>
<div class="codehilite"><pre><span></span><code><span class="n">book_obj</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Books</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">,</span><span class="s2">&quot;price&quot;</span><span class="p">)</span>
<span class="n">book</span> <span class="o">=</span> <span class="n">book_obj</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">book_obj</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">book_obj</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">book</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">book</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="p">(</span><span class="mf">0.000</span><span class="p">)</span> <span class="n">SELECT</span> <span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`title`</span><span class="p">,</span> <span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`price`</span> <span class="n">FROM</span> <span class="sb">`app01_books`</span> <span class="n">ORDER</span> <span class="n">BY</span> <span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`id`</span> <span class="n">ASC</span> <span class="n">LIMIT</span> <span class="mi">1</span><span class="p">;</span> <span class="n">args</span><span class="o">=</span><span class="p">()</span>
<span class="p">(</span><span class="mf">0.001</span><span class="p">)</span> <span class="n">SELECT</span> <span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`title`</span><span class="p">,</span> <span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`price`</span> <span class="n">FROM</span> <span class="sb">`app01_books`</span> <span class="n">LIMIT</span> <span class="mi">21</span><span class="p">;</span> <span class="n">args</span><span class="o">=</span><span class="p">()</span>
<span class="o">&lt;</span><span class="n">QuerySet</span> <span class="p">[{</span><span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;potter&#39;</span><span class="p">,</span> <span class="s1">&#39;price&#39;</span><span class="p">:</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;24.03&#39;</span><span class="p">)},</span> <span class="p">{</span><span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;西游记&#39;</span><span class="p">,</span> <span class="s1">&#39;price&#39;</span><span class="p">:</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;333.44&#39;</span><span class="p">)}]</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">django</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">query</span><span class="o">.</span><span class="n">QuerySet</span><span class="s1">&#39;&gt;</span>
<span class="p">{</span><span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;potter&#39;</span><span class="p">,</span> <span class="s1">&#39;price&#39;</span><span class="p">:</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;24.03&#39;</span><span class="p">)}</span>
<span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">dict</span><span class="s1">&#39;&gt;</span>
</code></pre></div>

<h6 id="8values_list">8.values_list()<a class="headerlink" href="#8values_list" title="Permanent link">&para;</a></h6>
<p>获取数据对象中指定的字段的值,返回queryset对象,形式为列表套元组.</p>
<div class="codehilite"><pre><span></span><code><span class="n">book_obj</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Books</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">values_list</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">,</span><span class="s2">&quot;price&quot;</span><span class="p">)</span>
<span class="n">book</span> <span class="o">=</span> <span class="n">book_obj</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">book_obj</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">book_obj</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">book</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">book</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">book</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">book</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="k">print</span><span class="p">(</span><span class="n">book</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">book</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="p">(</span><span class="mf">0.000</span><span class="p">)</span> <span class="n">SELECT</span> <span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`title`</span><span class="p">,</span> <span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`price`</span> <span class="n">FROM</span> <span class="sb">`app01_books`</span> <span class="n">ORDER</span> <span class="n">BY</span> <span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`id`</span> <span class="n">ASC</span> <span class="n">LIMIT</span> <span class="mi">1</span><span class="p">;</span> <span class="n">args</span><span class="o">=</span><span class="p">()</span>
<span class="p">(</span><span class="mf">0.001</span><span class="p">)</span> <span class="n">SELECT</span> <span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`title`</span><span class="p">,</span> <span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`price`</span> <span class="n">FROM</span> <span class="sb">`app01_books`</span> <span class="n">LIMIT</span> <span class="mi">21</span><span class="p">;</span> <span class="n">args</span><span class="o">=</span><span class="p">()</span>
<span class="o">&lt;</span><span class="n">QuerySet</span> <span class="p">[(</span><span class="s1">&#39;potter&#39;</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;24.03&#39;</span><span class="p">)),</span> <span class="p">(</span><span class="s1">&#39;西游记&#39;</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;333.44&#39;</span><span class="p">))]</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">django</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">query</span><span class="o">.</span><span class="n">QuerySet</span><span class="s1">&#39;&gt;</span>
<span class="p">(</span><span class="s1">&#39;potter&#39;</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;24.03&#39;</span><span class="p">))</span>
<span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">tuple</span><span class="s1">&#39;&gt;</span>
<span class="n">potter</span>
<span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">str</span><span class="s1">&#39;&gt;</span>
<span class="mf">24.03</span>
<span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="s1">&#39;&gt;</span>
</code></pre></div>

<h6 id="9order_by">9.order_by()<a class="headerlink" href="#9order_by" title="Permanent link">&para;</a></h6>
<p>按照指定字段排序,默认升序,返回queryset对象,形式列表套对象</p>
<div class="codehilite"><pre><span></span><code><span class="n">book_obj</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Books</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">book_obj</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">book_obj</span><span class="p">))</span>
<span class="n">book</span> <span class="o">=</span> <span class="n">book_obj</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">book</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">book</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="p">(</span><span class="mf">0.013</span><span class="p">)</span> <span class="n">SELECT</span> <span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`id`</span><span class="p">,</span> <span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`title`</span><span class="p">,</span> <span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`price`</span><span class="p">,</span> <span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`publishdata`</span> <span class="n">FROM</span> <span class="sb">`app01_books`</span> <span class="n">ORDER</span> <span class="n">BY</span> <span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`id`</span> <span class="n">ASC</span> <span class="n">LIMIT</span> <span class="mi">21</span><span class="p">;</span> <span class="n">args</span><span class="o">=</span><span class="p">()</span>
<span class="p">(</span><span class="mf">0.001</span><span class="p">)</span> <span class="n">SELECT</span> <span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`id`</span><span class="p">,</span> <span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`title`</span><span class="p">,</span> <span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`price`</span><span class="p">,</span> <span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`publishdata`</span> <span class="n">FROM</span> <span class="sb">`app01_books`</span> <span class="n">ORDER</span> <span class="n">BY</span> <span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`id`</span> <span class="n">ASC</span> <span class="n">LIMIT</span> <span class="mi">1</span><span class="p">;</span> <span class="n">args</span><span class="o">=</span><span class="p">()</span>
<span class="o">&lt;</span><span class="n">QuerySet</span> <span class="p">[</span><span class="o">&lt;</span><span class="n">Books</span><span class="p">:</span> <span class="n">Books</span> <span class="nb">object</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">Books</span><span class="p">:</span> <span class="n">Books</span> <span class="nb">object</span><span class="o">&gt;</span><span class="p">]</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">django</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">query</span><span class="o">.</span><span class="n">QuerySet</span><span class="s1">&#39;&gt;</span>
<span class="n">Books</span> <span class="nb">object</span>
<span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">app01</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">Books</span><span class="s1">&#39;&gt;</span>
</code></pre></div>

<p>注意:如果要降序,在字段前加负号走<code>-</code></p>
<h6 id="10reverse">10.reverse()<a class="headerlink" href="#10reverse" title="Permanent link">&para;</a></h6>
<p>对查询结果颠倒顺序,返回queryset对象,形式列表对象</p>
<p>也就是前提必须时排序的输出才可以使用reverse()方法</p>
<div class="codehilite"><pre><span></span><code><span class="n">book_obj</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Books</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">)</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">book_obj</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">book_obj</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="p">(</span><span class="mf">0.001</span><span class="p">)</span> <span class="n">SELECT</span> <span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`id`</span><span class="p">,</span> <span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`title`</span><span class="p">,</span> <span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`price`</span><span class="p">,</span> <span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`publishdata`</span> <span class="n">FROM</span> <span class="sb">`app01_books`</span> <span class="n">ORDER</span> <span class="n">BY</span> <span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`id`</span> <span class="n">ASC</span> <span class="n">LIMIT</span> <span class="mi">21</span><span class="p">;</span> <span class="n">args</span><span class="o">=</span><span class="p">()</span>
<span class="p">(</span><span class="mf">0.000</span><span class="p">)</span> <span class="n">SELECT</span> <span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`id`</span><span class="p">,</span> <span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`title`</span><span class="p">,</span> <span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`price`</span><span class="p">,</span> <span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`publishdata`</span> <span class="n">FROM</span> <span class="sb">`app01_books`</span> <span class="n">ORDER</span> <span class="n">BY</span> <span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`id`</span> <span class="n">DESC</span> <span class="n">LIMIT</span> <span class="mi">21</span><span class="p">;</span> <span class="n">args</span><span class="o">=</span><span class="p">()</span>
<span class="o">&lt;</span><span class="n">QuerySet</span> <span class="p">[</span><span class="o">&lt;</span><span class="n">Books</span><span class="p">:</span> <span class="n">Books</span> <span class="nb">object</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">Books</span><span class="p">:</span> <span class="n">Books</span> <span class="nb">object</span><span class="o">&gt;</span><span class="p">]</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">QuerySet</span> <span class="p">[</span><span class="o">&lt;</span><span class="n">Books</span><span class="p">:</span> <span class="n">Books</span> <span class="nb">object</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">Books</span><span class="p">:</span> <span class="n">Books</span> <span class="nb">object</span><span class="o">&gt;</span><span class="p">]</span><span class="o">&gt;</span>
</code></pre></div>

<h6 id="11exclude">11.exclude()<a class="headerlink" href="#11exclude" title="Permanent link">&para;</a></h6>
<p>排除<code>()</code>中选项,返回queryset对象,形式列表套对象</p>
<div class="codehilite"><pre><span></span><code><span class="n">book_obj</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Books</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">exclude</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">book_obj</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">book_obj</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="p">(</span><span class="mf">0.001</span><span class="p">)</span> <span class="n">SELECT</span> <span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`id`</span><span class="p">,</span> <span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`title`</span><span class="p">,</span> <span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`price`</span><span class="p">,</span> <span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`publishdata`</span> <span class="n">FROM</span> <span class="sb">`app01_books`</span> <span class="n">WHERE</span> <span class="n">NOT</span> <span class="p">(</span><span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`id`</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span> <span class="n">LIMIT</span> <span class="mi">21</span><span class="p">;</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,)</span>
<span class="o">&lt;</span><span class="n">QuerySet</span> <span class="p">[</span><span class="o">&lt;</span><span class="n">Books</span><span class="p">:</span> <span class="n">Books</span> <span class="nb">object</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">Books</span><span class="p">:</span> <span class="n">Books</span> <span class="nb">object</span><span class="o">&gt;</span><span class="p">]</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">django</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">query</span><span class="o">.</span><span class="n">QuerySet</span><span class="s1">&#39;&gt;</span>
</code></pre></div>

<h6 id="12exists">12.exists()<a class="headerlink" href="#12exists" title="Permanent link">&para;</a></h6>
<p>判断查询结果是否有值,返回bool</p>
<div class="codehilite"><pre><span></span><code><span class="n">book_obj</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Books</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">exclude</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">book_obj</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">book_obj</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="p">(</span><span class="mf">0.000</span><span class="p">)</span> <span class="n">SELECT</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="n">AS</span> <span class="sb">`a`</span> <span class="n">FROM</span> <span class="sb">`app01_books`</span> <span class="n">WHERE</span> <span class="n">NOT</span> <span class="p">(</span><span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`id`</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span> <span class="n">LIMIT</span> <span class="mi">1</span><span class="p">;</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,)</span>
<span class="bp">True</span>
<span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">bool</span><span class="s1">&#39;&gt;</span>
</code></pre></div>

<h6 id="13distinct">13.distinct()<a class="headerlink" href="#13distinct" title="Permanent link">&para;</a></h6>
<p>对查询结果去重,返回queryset对象,形式列表套字典</p>
<p>去重的前提是数据必须==完全==一致,id容易忽略</p>
<div class="codehilite"><pre><span></span><code><span class="n">book_obj</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Books</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">,</span><span class="s2">&quot;price&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">book_obj</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">book_obj</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="p">(</span><span class="mf">0.000</span><span class="p">)</span> <span class="n">SELECT</span> <span class="n">DISTINCT</span> <span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`title`</span><span class="p">,</span> <span class="sb">`app01_books`</span><span class="o">.</span><span class="sb">`price`</span> <span class="n">FROM</span> <span class="sb">`app01_books`</span> <span class="n">LIMIT</span> <span class="mi">21</span><span class="p">;</span> <span class="n">args</span><span class="o">=</span><span class="p">()</span>
<span class="o">&lt;</span><span class="n">QuerySet</span> <span class="p">[{</span><span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;potter&#39;</span><span class="p">,</span> <span class="s1">&#39;price&#39;</span><span class="p">:</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;24.03&#39;</span><span class="p">)},</span> <span class="p">{</span><span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;西游记&#39;</span><span class="p">,</span> <span class="s1">&#39;price&#39;</span><span class="p">:</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;333.44&#39;</span><span class="p">)},</span> <span class="p">{</span><span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;herry&#39;</span><span class="p">,</span> <span class="s1">&#39;price&#39;</span><span class="p">:</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;555.00&#39;</span><span class="p">)}]</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">django</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">query</span><span class="o">.</span><span class="n">QuerySet</span><span class="s1">&#39;&gt;</span>
</code></pre></div>

<h3 id="_9">注意事项<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h3>
<ol>
<li>
<p>小数字段,超出范围,自动四舍五入</p>
</li>
<li>
<p>django建表字段默认not null</p>
</li>
<li>
<p>时间字段输入格式必须为:It must be in YYYY-MM-DD format.</p>
</li>
<li>
<p><code>pk</code>会自动找到当前表的主键字段</p>
</li>
<li>
<p>filter查询出来的是一个queryset对象</p>
</li>
</ol>
<p>queryset对象可以无线调用queryset的方法(链式无线点下去)</p>
<p>queryset对象可以使用<code>res.query</code>方法查看当前结果内部对应的sql语句.</p>
<h1 id="_10">双下划线查询<a class="headerlink" href="#_10" title="Permanent link">&para;</a></h1>
<ul>
<li><code>__gt</code> 大于</li>
<li><code>__lt</code> 小于</li>
<li><code>__gte</code> 大于等于</li>
<li><code>__lte</code> 小于等于</li>
<li><code>__range</code> 范围查询 顾头顾尾</li>
<li><code>__in</code> 在里面</li>
<li><code>__year</code></li>
<li><code>__month</code></li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="c1"># 查询价格大于500的书籍</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Books</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">price__gt</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<span class="c1"># 查询价格小于400 的书籍</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Books</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">price__lt</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<span class="c1"># 查询价格大于等于500</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Books</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">price__gte</span><span class="o">=</span><span class="mf">444.66</span><span class="p">)</span>  <span class="err">对数字精确度不敏感</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Books</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">price__gte</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<span class="c1"># 查询价格小于等于500的书籍</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Books</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">price__lte</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>

<span class="c1"># 查询价格是222.66或者444.22或者500的书籍</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Books</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">price__in</span><span class="o">=</span><span class="p">[</span><span class="mi">222</span><span class="p">,</span><span class="mi">444</span><span class="p">,</span><span class="mi">500</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>

<span class="c1"># 查询价格在200到800之间的书籍</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Books</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">price__range</span><span class="o">=</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span><span class="mi">800</span><span class="p">))</span>  <span class="c1"># 顾头顾尾</span>
<span class="k">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>

<span class="c1"># 查询出版日期是2019年的书籍</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Books</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">publishdate__year</span><span class="o">=</span><span class="s1">&#39;2019&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<span class="c1"># 查询出版日期是1月份的书籍</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Books</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">publishdate__month</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</code></pre></div>

<ul>
<li><code>__startswitch</code> 以....开头</li>
<li><code>__endswith</code> 以...结尾</li>
<li><code>__contains</code> 包含 如果查询字母，默认区分大小写</li>
<li><code>__icontains</code> 加 <code>i</code> 忽略大小写</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="c1"># 查询书籍是以“人”开头的书</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Books</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">title__startswith</span><span class="o">=</span><span class="s1">&#39;人&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>

<span class="c1"># 查询书籍是以“梦”结尾的书</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Books</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">title__endswith</span><span class="o">=</span><span class="s1">&#39;梦&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>

<span class="c1"># 查询书籍名称中包含“的”字的书籍</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Books</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">title__contains</span><span class="o">=</span><span class="s1">&#39;的&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>

<span class="c1"># 查询书籍名称中包含字母p的书籍</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Books</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">title__contains</span><span class="o">=</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>   <span class="c1"># 默认区分大小写</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Books</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">title__icontains</span><span class="o">=</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>  <span class="c1"># 加i不区分大小</span>
</code></pre></div>

<h1 id="_11">模糊查询<a class="headerlink" href="#_11" title="Permanent link">&para;</a></h1>
<h5 id="mysql">MySQL中的模糊查询<a class="headerlink" href="#mysql" title="Permanent link">&para;</a></h5>
<p>关键字like</p>
<p>模糊匹配符号</p>
<div class="codehilite"><pre><span></span><code>`%`:匹配任何个数的任意字符

`_`:匹配一位任意的字符
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="c1"># 查询书籍是以三开头的书</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Books</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">title__startswith</span><span class="o">=</span><span class="s1">&#39;三&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<span class="c1"># 查询书籍是以义结尾的书</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Books</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">title__endswith</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<span class="c1"># 查询书籍名称中包含游字的书籍</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Books</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">title__contains</span><span class="o">=</span><span class="s1">&#39;游&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>

<span class="c1"># 查询书籍名称中包含字母p的书籍</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Books</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">title__contains</span><span class="o">=</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>  <span class="c1"># 默认区分大小写</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Books</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">title__icontains</span><span class="o">=</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>  <span class="c1"># 忽略大小写 加i</span>
<span class="k">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</code></pre></div>

<h1 id="_12">多表操作<a class="headerlink" href="#_12" title="Permanent link">&para;</a></h1>
<h3 id="_13">一对多表<a class="headerlink" href="#_13" title="Permanent link">&para;</a></h3>
<h5 id="_14">增<a class="headerlink" href="#_14" title="Permanent link">&para;</a></h5>
<p>方法一: </p>
<p>直接传表里面的实际字段 跟数据主键值 </p>
<div class="codehilite"><pre><span></span><code><span class="n">models</span><span class="o">.</span><span class="n">Book</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;三国演义&#39;</span><span class="p">,</span><span class="n">price</span><span class="o">=</span><span class="mf">222.33</span><span class="p">,</span><span class="n">publish_id</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>

<p>方法二:</p>
<p>传虚拟字段  跟数据对象即可</p>
<div class="codehilite"><pre><span></span><code><span class="n">publish_obj</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Publish</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
<span class="n">models</span><span class="o">.</span><span class="n">Book</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;红楼梦&#39;</span><span class="p">,</span><span class="n">price</span><span class="o">=</span><span class="mf">444.33</span><span class="p">,</span><span class="n">publish</span><span class="o">=</span><span class="n">publish_obj</span><span class="p">)</span><span class="c1">#publish为外键</span>
</code></pre></div>

<h5 id="_15">查<a class="headerlink" href="#_15" title="Permanent link">&para;</a></h5>
<p>同上</p>
<h5 id="_16">改<a class="headerlink" href="#_16" title="Permanent link">&para;</a></h5>
<p>方法一,直接update</p>
<div class="codehilite"><pre><span></span><code><span class="n">models</span><span class="o">.</span><span class="n">Book</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">publish_id</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</code></pre></div>

<p>方法二,通过对象</p>
<div class="codehilite"><pre><span></span><code><span class="n">publish_obj</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Publish</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
<span class="n">models</span><span class="o">.</span><span class="n">Book</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">publish</span><span class="o">=</span><span class="n">publish_obj</span><span class="p">)</span>
</code></pre></div>

<h5 id="_17">删<a class="headerlink" href="#_17" title="Permanent link">&para;</a></h5>
<p>默认就是级联删除 级联更新</p>
<div class="codehilite"><pre><span></span><code><span class="n">models</span><span class="o">.</span><span class="n">Publish</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span> 
</code></pre></div>

<h3 id="_18">多对多表<a class="headerlink" href="#_18" title="Permanent link">&para;</a></h3>
<h5 id="_19">增<a class="headerlink" href="#_19" title="Permanent link">&para;</a></h5>
<p>add方法,先选出对象,使用对象<code>.</code>方法到达表</p>
<div class="codehilite"><pre><span></span><code><span class="c1">#先获取对象</span>
<span class="n">book_obj</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Book</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
<span class="c1">#使用.方法到达被关联表</span>
<span class="n">book_obj</span><span class="o">.</span><span class="n">author</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</code></pre></div>

<p>向第三张关系表添加数据</p>
<p>支持传数字   add(1,2)</p>
<div class="codehilite"><pre><span></span><code><span class="n">book_obj</span><span class="o">.</span><span class="n">author</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="p">(</span><span class="mf">0.191</span><span class="p">)</span> <span class="n">INSERT</span> <span class="n">INTO</span> <span class="sb">`app01_book_author`</span> <span class="p">(</span><span class="sb">`book_id`</span><span class="p">,</span> <span class="sb">`author_id`</span><span class="p">)</span> <span class="n">VALUES</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</code></pre></div>

<p>也支持传对象  add(author_obj,author_obj)</p>
<div class="codehilite"><pre><span></span><code><span class="c1">#获取author对象</span>
<span class="n">author_obj</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
<span class="n">book_obj</span><span class="o">.</span><span class="n">authors</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">author_obj</span><span class="p">,</span><span class="n">author_obj1</span><span class="p">)</span>
</code></pre></div>

<p>add后可传至少一个值</p>
<h5 id="_20">改<a class="headerlink" href="#_20" title="Permanent link">&para;</a></h5>
<p>set()方法修改多对多表关系中的数据</p>
<p>可以传数字或是对象</p>
<div class="codehilite"><pre><span></span><code><span class="n">book_obj</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Book</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
<span class="n">book_obj</span><span class="o">.</span><span class="n">authors</span><span class="o">.</span><span class="n">set</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">book_obj</span><span class="o">.</span><span class="n">authors</span><span class="o">.</span><span class="n">set</span><span class="p">([</span><span class="mi">1</span><span class="p">,])</span>
<span class="n">author_obj</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
<span class="n">author_obj1</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
<span class="n">book_obj</span><span class="o">.</span><span class="n">authors</span><span class="o">.</span><span class="n">set</span><span class="p">((</span><span class="n">author_obj</span><span class="p">,</span><span class="n">author_obj1</span><span class="p">))</span>
</code></pre></div>

<p><code>()</code>中必须是可迭代对象,可迭代对可为多个</p>
<h5 id="_21">删<a class="headerlink" href="#_21" title="Permanent link">&para;</a></h5>
<h6 id="remove">remove方法<a class="headerlink" href="#remove" title="Permanent link">&para;</a></h6>
<p>remove可以传数字或者对象,支持多个</p>
<div class="codehilite"><pre><span></span><code><span class="n">book_obj</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Book</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
<span class="n">book_obj</span><span class="o">.</span><span class="n">authors</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">book_obj</span><span class="o">.</span><span class="n">authors</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">author_obj</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
<span class="n">author_obj1</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
<span class="n">book_obj</span><span class="o">.</span><span class="n">authors</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">author_obj</span><span class="p">)</span>
<span class="n">book_obj</span><span class="o">.</span><span class="n">authors</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">author_obj</span><span class="p">,</span><span class="n">author_obj1</span><span class="p">)</span>
</code></pre></div>

<h6 id="clear">clear()方法<a class="headerlink" href="#clear" title="Permanent link">&para;</a></h6>
<p>清空筛选出来所有记录,不需要传参</p>
<div class="codehilite"><pre><span></span><code><span class="n">book_obj</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Book</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
<span class="n">book_obj</span><span class="o">.</span><span class="n">authors</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</code></pre></div>

<h1 id="_22">跨表查询<a class="headerlink" href="#_22" title="Permanent link">&para;</a></h1>
<h3 id="_23">正反向查询<a class="headerlink" href="#_23" title="Permanent link">&para;</a></h3>
<p>外键字段在谁那,由谁查,谁就是正向</p>
<p>正向查询按字段</p>
<p>反向查询按表名小写</p>
<h3 id="_24">子查询<a class="headerlink" href="#_24" title="Permanent link">&para;</a></h3>
<h5 id="_25">基于对象的跨表查询<a class="headerlink" href="#_25" title="Permanent link">&para;</a></h5>
<p>相当于子查询,分表操作</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># 1.查询书籍主键为2的出版社名称</span>
<span class="n">book_obj</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Book</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">book_obj</span><span class="o">.</span><span class="n">publish</span><span class="p">)</span>  <span class="c1"># 出版社对象</span>
<span class="k">print</span><span class="p">(</span><span class="n">book_obj</span><span class="o">.</span><span class="n">publish</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="c1"># 2.查询书籍主键为4的作者姓名?</span>
<span class="n">book_obj</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Book</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">book_obj</span><span class="o">.</span><span class="n">authors</span><span class="p">)</span>  <span class="c1"># app01.Author.None</span>
<span class="k">print</span><span class="p">(</span><span class="n">book_obj</span><span class="o">.</span><span class="n">authors</span><span class="o">.</span><span class="n">all</span><span class="p">())</span>
<span class="c1"># 3.查询作者是jason的手机号码</span>
<span class="n">author_obj</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;jason&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">author_obj</span><span class="o">.</span><span class="n">author_detail</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">author_obj</span><span class="o">.</span><span class="n">author_detail</span><span class="o">.</span><span class="n">phone</span><span class="p">)</span>
<span class="c1"># 4.查询出版社是东方出版社出版过的书籍</span>
<span class="n">publish_obj</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Publish</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;东方出版社&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
<span class="c1"># print(publish_obj.book_set)  # app01.Book.None</span>
<span class="k">print</span><span class="p">(</span><span class="n">publish_obj</span><span class="o">.</span><span class="n">book_set</span><span class="o">.</span><span class="n">all</span><span class="p">())</span>

<span class="c1"># 5.查询作者是jason写过的书籍</span>
<span class="n">author_obj</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;jason&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
<span class="c1"># print(author_obj.book_set)  # app01.Book.None</span>
<span class="k">print</span><span class="p">(</span><span class="n">author_obj</span><span class="o">.</span><span class="n">book_set</span><span class="o">.</span><span class="n">all</span><span class="p">())</span>  <span class="c1"># app01.Book.None</span>

<span class="c1"># 6.查询手机号是120的作者姓名</span>
<span class="n">author_detail_obj</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">AuthorDetail</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">phone</span><span class="o">=</span><span class="mi">120</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">author_detail_obj</span><span class="o">.</span><span class="n">author</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">author_detail_obj</span><span class="o">.</span><span class="n">author</span><span class="o">.</span><span class="n">email</span><span class="p">)</span>
</code></pre></div>

<h5 id="_26">注意<a class="headerlink" href="#_26" title="Permanent link">&para;</a></h5>
<p>出现app01.Book.None,加<code>all()</code></p>
<p>当正向查询点击外键字段数据有多个的情况下 需要.all()</p>
<p>当反向查询的时候表名小写需要加_set</p>
<p>all()和_set在一对多和多对多的时候加,一对一的时候不加</p>
<h3 id="_27">基于双下划线的跨表操作<a class="headerlink" href="#_27" title="Permanent link">&para;</a></h3>
<p>相当于mysql的联表操作</p>
<p>MySQL中的union:两边都写,不足的补null</p>
<p>models后面点的谁 就以谁为基表</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># 1.查询书籍pk为2的出版社名称</span>
<span class="c1"># 正向</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Book</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="s1">&#39;publish__name&#39;</span><span class="p">)</span>  
<span class="c1"># 写外键字段就相当于已经跨到外键字段所关联的表</span>
<span class="c1"># 你想要改表的哪个字段信息 你只需要加__获取即可</span>
<span class="k">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<span class="c1"># 反向</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Publish</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">book__pk</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>

<span class="c1"># 2.查询书籍pk为2的作者姓名和邮箱</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Book</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="s1">&#39;authors__name&#39;</span><span class="p">,</span><span class="s1">&#39;authors__email&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">book__pk</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span><span class="s1">&#39;email&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>

<span class="c1"># 3.查询作者是egon的家庭地址</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;egon&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="s1">&#39;author_detail__addr&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">AuthorDetail</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">author__name</span><span class="o">=</span><span class="s1">&#39;egon&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="s1">&#39;addr&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>

<span class="c1"># 4.查询出版社是东方出版社出版过的书的名字</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Publish</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;东方出版社&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="s1">&#39;book__title&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Book</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">publish__name</span><span class="o">=</span><span class="s1">&#39;东方出版社&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>

<span class="c1"># 5.查询书籍pk是2的作者的手机号  三表联查  可无限跨表联查values(外键字段1__外键字段2__外键字段3,,,)</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Book</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="s1">&#39;authors__author_detail__phone&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">book__pk</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="s1">&#39;author_detail__phone&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</code></pre></div>

<p>__字段就是拿到字段</p>
<p>models后是谁,谁就是基表.</p>
<h1 id="orm_1">ORM字段及参数<a class="headerlink" href="#orm_1" title="Permanent link">&para;</a></h1>
<h3 id="_28">字段<a class="headerlink" href="#_28" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p>datafield中
  auto_now:每次修改数据的时候 都会自动将当前修改时间更新上去  实时更新
    auto_now_add:在创建数据的时候 会将当前时间自动记录 之后不会自动修改  除非你人为修改</p>
</li>
<li>
<p>booleanField字段中</p>
</li>
</ul>
<p>传值只需要传True或False</p>
<p>存值时会自动存成1/0</p>
<ul>
<li>filefield 用来专门存放路径  <code>d/data/a.txt</code></li>
</ul>
<p>给该字段传值的时候 直接传文件对象</p>
<p>会自动将文件对象保存到upload_to后面指定的文件路径中</p>
<p>然后将路径保存到数据库</p>
<ul>
<li>decimalfield字段</li>
</ul>
<p>参数:</p>
<p>max_digits:小数总长度</p>
<p>decimal_places:小数位长度</p>
<ul>
<li>autofield</li>
</ul>
<p>设置主键字段必备</p>
<p>primary_key = True</p>
<ul>
<li>filefield</li>
</ul>
<p>存文件</p>
<p>upload_to = "文件夹路径"</p>
<ul>
<li>textgfield</li>
</ul>
<p>存大段文本</p>
<div class="codehilite"><pre><span></span><code><span class="n">AutoField</span><span class="p">(</span><span class="n">Field</span><span class="p">)</span>
        <span class="o">-</span> <span class="n">int自增列</span><span class="err">，必须填入参数</span> <span class="n">primary_key</span><span class="o">=</span><span class="bp">True</span>

    <span class="n">BigAutoField</span><span class="p">(</span><span class="n">AutoField</span><span class="p">)</span>
        <span class="o">-</span> <span class="n">bigint自增列</span><span class="err">，必须填入参数</span> <span class="n">primary_key</span><span class="o">=</span><span class="bp">True</span>

        <span class="err">注：当</span><span class="n">model中如果没有自增列</span><span class="err">，则自动会创建一个列名为</span><span class="n">id的列</span>
        <span class="kn">from</span> <span class="nn">django.db</span> <span class="kn">import</span> <span class="n">models</span>

        <span class="k">class</span> <span class="nc">UserInfo</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
            <span class="c1"># 自动创建一个列名为id的且为自增的整数列</span>
            <span class="n">username</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>

        <span class="k">class</span> <span class="nc">Group</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
            <span class="c1"># 自定义自增列</span>
            <span class="n">nid</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">AutoField</span><span class="p">(</span><span class="n">primary_key</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>

    <span class="n">SmallIntegerField</span><span class="p">(</span><span class="n">IntegerField</span><span class="p">):</span>
        <span class="o">-</span> <span class="err">小整数</span> <span class="o">-</span><span class="mi">32768</span> <span class="err">～</span> <span class="mi">32767</span>

    <span class="n">PositiveSmallIntegerField</span><span class="p">(</span><span class="n">PositiveIntegerRelDbTypeMixin</span><span class="p">,</span> <span class="n">IntegerField</span><span class="p">)</span>
        <span class="o">-</span> <span class="err">正小整数</span> <span class="mi">0</span> <span class="err">～</span> <span class="mi">32767</span>
    <span class="n">IntegerField</span><span class="p">(</span><span class="n">Field</span><span class="p">)</span>
        <span class="o">-</span> <span class="err">整数列</span><span class="p">(</span><span class="err">有符号的</span><span class="p">)</span> <span class="o">-</span><span class="mi">2147483648</span> <span class="err">～</span> <span class="mi">2147483647</span>

    <span class="n">PositiveIntegerField</span><span class="p">(</span><span class="n">PositiveIntegerRelDbTypeMixin</span><span class="p">,</span> <span class="n">IntegerField</span><span class="p">)</span>
        <span class="o">-</span> <span class="err">正整数</span> <span class="mi">0</span> <span class="err">～</span> <span class="mi">2147483647</span>

    <span class="n">BigIntegerField</span><span class="p">(</span><span class="n">IntegerField</span><span class="p">):</span>
        <span class="o">-</span> <span class="err">长整型</span><span class="p">(</span><span class="err">有符号的</span><span class="p">)</span> <span class="o">-</span><span class="mi">9223372036854775808</span> <span class="err">～</span> <span class="mi">9223372036854775807</span>

    <span class="n">BooleanField</span><span class="p">(</span><span class="n">Field</span><span class="p">)</span>
        <span class="o">-</span> <span class="err">布尔值类型</span> 

    <span class="n">NullBooleanField</span><span class="p">(</span><span class="n">Field</span><span class="p">):</span>
        <span class="o">-</span> <span class="err">可以为空的布尔值</span>

    <span class="n">CharField</span><span class="p">(</span><span class="n">Field</span><span class="p">)</span>
        <span class="o">-</span> <span class="err">字符类型</span>
        <span class="o">-</span> <span class="err">必须提供</span><span class="n">max_length参数</span><span class="err">，</span> <span class="n">max_length表示字符长度</span>

    <span class="n">TextField</span><span class="p">(</span><span class="n">Field</span><span class="p">)</span>
        <span class="o">-</span> <span class="err">文本类型</span>

    <span class="n">EmailField</span><span class="p">(</span><span class="n">CharField</span><span class="p">)</span><span class="err">：</span>
        <span class="o">-</span> <span class="err">字符串类型，</span><span class="n">Django</span> <span class="n">Admin以及ModelForm中提供验证机制</span>

    <span class="n">IPAddressField</span><span class="p">(</span><span class="n">Field</span><span class="p">)</span>
        <span class="o">-</span> <span class="err">字符串类型，</span><span class="n">Django</span> <span class="n">Admin以及ModelForm中提供验证</span> <span class="n">IPV4</span> <span class="err">机制</span>

    <span class="n">GenericIPAddressField</span><span class="p">(</span><span class="n">Field</span><span class="p">)</span>
        <span class="o">-</span> <span class="err">字符串类型，</span><span class="n">Django</span> <span class="n">Admin以及ModelForm中提供验证</span> <span class="n">Ipv4和Ipv6</span>
        <span class="o">-</span> <span class="err">参数：</span>
            <span class="n">protocol</span><span class="err">，用于指定</span><span class="n">Ipv4或Ipv6</span><span class="err">，</span> <span class="s1">&#39;both&#39;</span><span class="p">,</span><span class="s2">&quot;ipv4&quot;</span><span class="p">,</span><span class="s2">&quot;ipv6&quot;</span>
            <span class="n">unpack_ipv4</span><span class="err">，</span> <span class="err">如果指定为</span><span class="bp">True</span><span class="err">，则输入</span><span class="p">::</span><span class="n">ffff</span><span class="p">:</span><span class="mf">192.0</span><span class="o">.</span><span class="mf">2.1</span><span class="err">时候，可解析为</span><span class="mf">192.0</span><span class="o">.</span><span class="mf">2.1</span><span class="err">，开启此功能，需要</span><span class="n">protocol</span><span class="o">=</span><span class="s2">&quot;both&quot;</span>

    <span class="n">URLField</span><span class="p">(</span><span class="n">CharField</span><span class="p">)</span>
        <span class="o">-</span> <span class="err">字符串类型，</span><span class="n">Django</span> <span class="n">Admin以及ModelForm中提供验证</span> <span class="n">URL</span>

    <span class="n">SlugField</span><span class="p">(</span><span class="n">CharField</span><span class="p">)</span>
        <span class="o">-</span> <span class="err">字符串类型，</span><span class="n">Django</span> <span class="n">Admin以及ModelForm中提供验证支持</span> <span class="err">字母、数字、下划线、连接符（减号）</span>

    <span class="n">CommaSeparatedIntegerField</span><span class="p">(</span><span class="n">CharField</span><span class="p">)</span>
        <span class="o">-</span> <span class="err">字符串类型，格式必须为逗号分割的数字</span>

    <span class="n">UUIDField</span><span class="p">(</span><span class="n">Field</span><span class="p">)</span>
        <span class="o">-</span> <span class="err">字符串类型，</span><span class="n">Django</span> <span class="n">Admin以及ModelForm中提供对UUID格式的验证</span>

    <span class="n">FilePathField</span><span class="p">(</span><span class="n">Field</span><span class="p">)</span>
        <span class="o">-</span> <span class="err">字符串，</span><span class="n">Django</span> <span class="n">Admin以及ModelForm中提供读取文件夹下文件的功能</span>
        <span class="o">-</span> <span class="err">参数：</span>
                <span class="n">path</span><span class="p">,</span>                      <span class="err">文件夹路径</span>
                <span class="n">match</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>                <span class="err">正则匹配</span>
                <span class="n">recursive</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>           <span class="err">递归下面的文件夹</span>
                <span class="n">allow_files</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>          <span class="err">允许文件</span>
                <span class="n">allow_folders</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>       <span class="err">允许文件夹</span>

    <span class="n">FileField</span><span class="p">(</span><span class="n">Field</span><span class="p">)</span>
        <span class="o">-</span> <span class="err">字符串，路径保存在数据库，文件上传到指定目录</span>
        <span class="o">-</span> <span class="err">参数：</span>
            <span class="n">upload_to</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>      <span class="err">上传文件的保存路径</span>
            <span class="n">storage</span> <span class="o">=</span> <span class="bp">None</span>      <span class="err">存储组件，默认</span><span class="n">django</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">files</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">FileSystemStorage</span>

    <span class="n">ImageField</span><span class="p">(</span><span class="n">FileField</span><span class="p">)</span>
        <span class="o">-</span> <span class="err">字符串，路径保存在数据库，文件上传到指定目录</span>
        <span class="o">-</span> <span class="err">参数：</span>
            <span class="n">upload_to</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>      <span class="err">上传文件的保存路径</span>
            <span class="n">storage</span> <span class="o">=</span> <span class="bp">None</span>      <span class="err">存储组件，默认</span><span class="n">django</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">files</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">FileSystemStorage</span>
            <span class="n">width_field</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>   <span class="err">上传图片的高度保存的数据库字段名（字符串）</span>
            <span class="n">height_field</span><span class="o">=</span><span class="bp">None</span>   <span class="err">上传图片的宽度保存的数据库字段名（字符串）</span>

    <span class="n">DateTimeField</span><span class="p">(</span><span class="n">DateField</span><span class="p">)</span>
        <span class="o">-</span> <span class="err">日期</span><span class="o">+</span><span class="err">时间格式</span> <span class="n">YYYY</span><span class="o">-</span><span class="n">MM</span><span class="o">-</span><span class="n">DD</span> <span class="n">HH</span><span class="p">:</span><span class="n">MM</span><span class="p">[:</span><span class="n">ss</span><span class="p">[</span><span class="o">.</span><span class="n">uuuuuu</span><span class="p">]][</span><span class="n">TZ</span><span class="p">]</span>

    <span class="n">DateField</span><span class="p">(</span><span class="n">DateTimeCheckMixin</span><span class="p">,</span> <span class="n">Field</span><span class="p">)</span>
        <span class="o">-</span> <span class="err">日期格式</span>      <span class="n">YYYY</span><span class="o">-</span><span class="n">MM</span><span class="o">-</span><span class="n">DD</span>

    <span class="n">TimeField</span><span class="p">(</span><span class="n">DateTimeCheckMixin</span><span class="p">,</span> <span class="n">Field</span><span class="p">)</span>
        <span class="o">-</span> <span class="err">时间格式</span>      <span class="n">HH</span><span class="p">:</span><span class="n">MM</span><span class="p">[:</span><span class="n">ss</span><span class="p">[</span><span class="o">.</span><span class="n">uuuuuu</span><span class="p">]]</span>

    <span class="n">DurationField</span><span class="p">(</span><span class="n">Field</span><span class="p">)</span>
        <span class="o">-</span> <span class="err">长整数，时间间隔，数据库中按照</span><span class="n">bigint存储</span><span class="err">，</span><span class="n">ORM中获取的值为datetime</span><span class="o">.</span><span class="n">timedelta类型</span>

    <span class="n">FloatField</span><span class="p">(</span><span class="n">Field</span><span class="p">)</span>
        <span class="o">-</span> <span class="err">浮点型</span>

    <span class="n">DecimalField</span><span class="p">(</span><span class="n">Field</span><span class="p">)</span>
        <span class="o">-</span> <span class="mi">10</span><span class="err">进制小数</span>
        <span class="o">-</span> <span class="err">参数：</span>
            <span class="n">max_digits</span><span class="err">，小数总长度</span>
            <span class="n">decimal_places</span><span class="err">，小数位长度</span>

    <span class="n">BinaryField</span><span class="p">(</span><span class="n">Field</span><span class="p">)</span>
        <span class="o">-</span> <span class="err">二进制类型</span>

 <span class="err">字段合集</span>
</code></pre></div>

<p>ORM字段与MySQL字段对应关系</p>
<div class="codehilite"><pre><span></span><code><span class="err">对应关系：</span>
    <span class="s1">&#39;AutoField&#39;</span><span class="p">:</span> <span class="s1">&#39;integer AUTO_INCREMENT&#39;</span><span class="p">,</span>
    <span class="s1">&#39;BigAutoField&#39;</span><span class="p">:</span> <span class="s1">&#39;bigint AUTO_INCREMENT&#39;</span><span class="p">,</span>
    <span class="s1">&#39;BinaryField&#39;</span><span class="p">:</span> <span class="s1">&#39;longblob&#39;</span><span class="p">,</span>
    <span class="s1">&#39;BooleanField&#39;</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span><span class="p">,</span>
    <span class="s1">&#39;CharField&#39;</span><span class="p">:</span> <span class="s1">&#39;varchar(</span><span class="si">%(max_length)s</span><span class="s1">)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;CommaSeparatedIntegerField&#39;</span><span class="p">:</span> <span class="s1">&#39;varchar(</span><span class="si">%(max_length)s</span><span class="s1">)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;DateField&#39;</span><span class="p">:</span> <span class="s1">&#39;date&#39;</span><span class="p">,</span>
    <span class="s1">&#39;DateTimeField&#39;</span><span class="p">:</span> <span class="s1">&#39;datetime&#39;</span><span class="p">,</span>
    <span class="s1">&#39;DecimalField&#39;</span><span class="p">:</span> <span class="s1">&#39;numeric(</span><span class="si">%(max_digits)s</span><span class="s1">, </span><span class="si">%(decimal_places)s</span><span class="s1">)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;DurationField&#39;</span><span class="p">:</span> <span class="s1">&#39;bigint&#39;</span><span class="p">,</span>
    <span class="s1">&#39;FileField&#39;</span><span class="p">:</span> <span class="s1">&#39;varchar(</span><span class="si">%(max_length)s</span><span class="s1">)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;FilePathField&#39;</span><span class="p">:</span> <span class="s1">&#39;varchar(</span><span class="si">%(max_length)s</span><span class="s1">)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;FloatField&#39;</span><span class="p">:</span> <span class="s1">&#39;double precision&#39;</span><span class="p">,</span>
    <span class="s1">&#39;IntegerField&#39;</span><span class="p">:</span> <span class="s1">&#39;integer&#39;</span><span class="p">,</span>
    <span class="s1">&#39;BigIntegerField&#39;</span><span class="p">:</span> <span class="s1">&#39;bigint&#39;</span><span class="p">,</span>
    <span class="s1">&#39;IPAddressField&#39;</span><span class="p">:</span> <span class="s1">&#39;char(15)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;GenericIPAddressField&#39;</span><span class="p">:</span> <span class="s1">&#39;char(39)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NullBooleanField&#39;</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span><span class="p">,</span>
    <span class="s1">&#39;OneToOneField&#39;</span><span class="p">:</span> <span class="s1">&#39;integer&#39;</span><span class="p">,</span>
    <span class="s1">&#39;PositiveIntegerField&#39;</span><span class="p">:</span> <span class="s1">&#39;integer UNSIGNED&#39;</span><span class="p">,</span>
    <span class="s1">&#39;PositiveSmallIntegerField&#39;</span><span class="p">:</span> <span class="s1">&#39;smallint UNSIGNED&#39;</span><span class="p">,</span>
    <span class="s1">&#39;SlugField&#39;</span><span class="p">:</span> <span class="s1">&#39;varchar(</span><span class="si">%(max_length)s</span><span class="s1">)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;SmallIntegerField&#39;</span><span class="p">:</span> <span class="s1">&#39;smallint&#39;</span><span class="p">,</span>
    <span class="s1">&#39;TextField&#39;</span><span class="p">:</span> <span class="s1">&#39;longtext&#39;</span><span class="p">,</span>
    <span class="s1">&#39;TimeField&#39;</span><span class="p">:</span> <span class="s1">&#39;time&#39;</span><span class="p">,</span>
    <span class="s1">&#39;UUIDField&#39;</span><span class="p">:</span> <span class="s1">&#39;char(32)&#39;</span><span class="p">,</span>
</code></pre></div>

<h1 id="_29">自定义字段<a class="headerlink" href="#_29" title="Permanent link">&para;</a></h1>
<div class="codehilite"><pre><span></span><code><span class="c1">#自定义char字段</span>
<span class="k">class</span> <span class="nc">MyCharField</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Field</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">max_length</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_length</span> <span class="o">=</span> <span class="n">max_length</span>
        <span class="c1"># 重新调用父类的方法</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="n">max_length</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


        <span class="k">def</span> <span class="nf">db_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">connection</span><span class="p">):</span>
            <span class="k">return</span> <span class="s1">&#39;char(</span><span class="si">%s</span><span class="s1">)&#39;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">max_length</span>
</code></pre></div>

<h1 id="orm_2">ORM优化查询<a class="headerlink" href="#orm_2" title="Permanent link">&para;</a></h1>
<h3 id="only">only()<a class="headerlink" href="#only" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="n">res</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Book</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">only</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">)</span>
</code></pre></div>

<p>返回列表套对象,对象只有括号中的字段</p>
<h3 id="defer">defer()<a class="headerlink" href="#defer" title="Permanent link">&para;</a></h3>
<p>返回列表套对象,对象除了括号中的字段都有</p>
<div class="codehilite"><pre><span></span><code><span class="n">res</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Book</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">defer</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">)</span>
</code></pre></div>

<p>注意:</p>
<p>only和defer后面继续点,依旧可以找到括号没没有的字段,但是会重新查询数据库,效率极低</p>
<h3 id="select_related">select_related()<a class="headerlink" href="#select_related" title="Permanent link">&para;</a></h3>
<p>()中只能放外键字段,只能在一对多或一对一中使用</p>
<p>返回queryset列表套对象</p>
<p>当于是SQL的inner join,将括号内外键字段多关联的表与当前表拼成一张表放在内存中.将表中的数据一个个查询出来封装成一个个对象.</p>
<p>()括号内可以放多个外键字段,用逗号隔开,会将多个外键字段关联表与当前表全部拼成一个大表放在内存中.</p>
<div class="codehilite"><pre><span></span><code>res = models.Book.objects.select_related(&#39;publish&#39;)
#publish是外键,res可以点book和publish中的字段
</code></pre></div>

<p>优点:跨表操作节省时间,减轻数据库的压力</p>
<p>耗时:数据库层面需要先联表.</p>
<h3 id="prefetch_related">prefetch_related()<a class="headerlink" href="#prefetch_related" title="Permanent link">&para;</a></h3>
<p>()括号中支持传多个外键字段,一对一,一对多,多对多都支持</p>
<p>返回queryset列表套对象</p>
<p>相当于SQL中的子查询</p>
<div class="codehilite"><pre><span></span><code><span class="n">res</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Book</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">prefetch_related</span><span class="p">(</span><span class="s1">&#39;publish&#39;</span><span class="p">,</span><span class="s1">&#39;authors&#39;</span><span class="p">)</span>
<span class="c1">#先查book表,再查publish表,再查authors表.查询一个数据,至少查三次</span>
</code></pre></div>

<p>特点:每多放一个外键字段,每查一个数据都会夺走多一条语句,多查询一张表,</p>
<div class="codehilite"><pre><span></span><code>    会自动帮你按外键字段,依次查询表然后将结果封装到一个对象中.
</code></pre></div>


<p>耗时:查询次数多</p>
<p>总结:</p>
<p>两张表都特别大的情况下,联表操作,可能耗时更多.</p>
<h2 id="orm_3">orm常用字段<a class="headerlink" href="#orm_3" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th align="left">字段名</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">AutoField</td>
<td>如果自己没有定义主键id，django会默认自动创建一个id字段，并把它作为主键</td>
</tr>
<tr>
<td align="left">IntegerField</td>
<td>一个整数类型,范围在 -2147483648 到 2147483647</td>
</tr>
<tr>
<td align="left">BigterField</td>
<td>bigint</td>
</tr>
<tr>
<td align="left">EmailField</td>
<td>varchar(254)</td>
</tr>
<tr>
<td align="left">BooleanField</td>
<td>布尔值，该字段在存储的时候 你只需要传布尔值True或False，它会自动存成1/0</td>
</tr>
<tr>
<td align="left">TextField</td>
<td>专门用来存大段文本</td>
</tr>
<tr>
<td align="left">FileFiled</td>
<td>专门用来存文件 upload_to=文件路径</td>
</tr>
<tr>
<td align="left">DecimalField(Field)</td>
<td>参数：<code>max_digits</code>，小数总长度， <code>decimal_places</code>，小数位长度</td>
</tr>
<tr>
<td align="left">CharField</td>
<td>对应MySQL中的varchar字段</td>
</tr>
<tr>
<td align="left">DateField</td>
<td></td>
</tr>
<tr>
<td align="left">DateTimeFiled</td>
<td></td>
</tr>
</tbody>
</table>
<div class="codehilite"><pre><span></span><code>DateTimeFiled`和`DateField`都有两个参数：`auto_now_add` 和 `auto_now
</code></pre></div>

<p><code>auto_now</code> 设为True ，每次更新数据记录的时候会更新该字段</p>
<p><code>auto_now_add</code>设为True， 创建数据记录的时候会把当前时间添加到数据库。</p>
<h1 id="choice">choice参数<a class="headerlink" href="#choice" title="Permanent link">&para;</a></h1>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">User</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">username</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>
    <span class="n">password</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">()</span>
    <span class="n">gender_choices</span> <span class="o">=</span> <span class="p">(</span>
        <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;男&#39;</span><span class="p">),</span>
        <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;女&#39;</span><span class="p">),</span>
        <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;其他&#39;</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="n">gender</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">(</span><span class="n">choices</span><span class="o">=</span><span class="n">gender_choices</span><span class="p">)</span>
</code></pre></div>

<p>数据库存储参数,调字段返回参数都是原数字,无论在不在gender_choices里面</p>
<p>若想显示男,女或其他,使用</p>
<div class="codehilite"><pre><span></span><code><span class="n">user_obj</span><span class="o">.</span><span class="n">get_gender_display</span><span class="p">()</span>
</code></pre></div>

<p>即可,若数据库中存了4,使用display()方法返回4.</p>
<h2 id="_30">字段参数<a class="headerlink" href="#_30" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th align="left">字段参数</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">null</td>
<td align="left">用于表示某个字段可以为空。</td>
</tr>
<tr>
<td align="left">unique</td>
<td align="left">如果设置为unique=True 则该字段在此表中必须是唯一的</td>
</tr>
<tr>
<td align="left">db_index</td>
<td align="left">db_index=True 则代表着为此字段设置索引。</td>
</tr>
<tr>
<td align="left">default</td>
<td align="left">为该字段设置默认值</td>
</tr>
<tr>
<td align="left">auto*now*add</td>
<td align="left">创建数据的时候，会把当前时间自动添加上去，之后就不再修改时间了，除非人为修改</td>
</tr>
<tr>
<td align="left">auto_now</td>
<td align="left">每次修改数据的时候，会自动更新当前时间，实时更新</td>
</tr>
</tbody>
</table>
<h2 id="_31">外键字段的参数<a class="headerlink" href="#_31" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th align="left">参数</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">to</td>
<td align="left">设置要关联的表</td>
</tr>
<tr>
<td align="left">to_field</td>
<td align="left">设置要关联的表字段，默认django自动关联主键</td>
</tr>
<tr>
<td align="left">on_delete</td>
<td align="left">当删除关联表中的数据时，当前与其关联的行为</td>
</tr>
<tr>
<td align="left">db_constraint</td>
<td align="left">是否在数据库中创建外键约束，默认是True</td>
</tr>
</tbody>
</table>
<div class="codehilite"><pre><span></span><code>on_delete = modeles.CASCADE   # 级联删除
</code></pre></div>

<p>注意：在django 2.x版本 需要手动指定 <code>db_constraint</code>等参数</p>
<h1 id="models">由数据库反向生成models<a class="headerlink" href="#models" title="Permanent link">&para;</a></h1>
<div class="codehilite"><pre><span></span><code><span class="n">python</span> <span class="n">manage</span><span class="o">.</span><span class="n">py</span> <span class="n">inspectdb</span> <span class="o">&gt;</span> <span class="n">app</span><span class="o">/</span><span class="n">models</span><span class="o">.</span><span class="n">py</span>
</code></pre></div>
                
                  
                
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../django%E4%B9%8B%E6%A8%A1%E6%9D%BF%E5%B1%82/" title="django之模板层" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                django之模板层
              </span>
            </div>
          </a>
        
        
          <a href="../django%E4%B9%8B%E5%88%86%E7%BB%84%E6%9F%A5%E8%AF%A2/" title="django之分组查询" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                django之分组查询
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2019 - 2020 Agsol
          </div>
        
        powered by
        <a href="https://www.mkdocs.org" target="_blank" rel="noopener">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.c33a9706.js"></script>
      
      <script>app.initialize({version:"1.1",url:{base:"../.."}})</script>
      
        <script src="../../javascripts/extra.js"></script>
      
    
  </body>
</html>